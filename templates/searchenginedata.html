<script>

    //Function Prototype    
    const sendSearchData = (keyword) => {
        $.ajax({
            type: "POST",
            url: "{% url 'search_engine' %}",
            data: {
                'csrfmiddlewaretoken': csrf_token,  //const csrf_token ==...
                'keyword': keyword,
            },
            success: function (response) {
                console.log(response)
                const data = response.data
                if (Array.isArray(data)) {

                    searchquery.innerHTML = " "  //start with empty
                    data.forEach(keyword => {
                        searchquery.innerHTML +=
                            `<div><b>${keyword.name}</b></div> `
                    })
                } else {
                    if (searchinput.value.length > 0) {
                        searchquery.innerHTML = `<b>${data}</b> `
                    } else {
                        searchquery.classList.add("invisible");
                    }
                }
            },
            error: function (error) {
                console.log(error.data)
            }
        })
    }


    const searchform = document.getElementById("search-form")
    const searchinput = document.getElementById("search-input")
    const searchquery = document.getElementById("search-query")

    const csrf_token = document.getElementsByName("csrfmiddlewaretoken")[0].value
    console.log(csrf_token)
    searchinput.addEventListener("keyup", e => {
        console.log("printing", e.target.value)
        if (searchquery.classList.contains('invisible')) {
            searchquery.classList.remove('invisible')
        }
        sendSearchData(e.target.value);
    })

</script>